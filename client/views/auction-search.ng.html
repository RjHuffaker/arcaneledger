<div ui-view="addAuctionModal" autoscroll="false"></div>

<div ui-view="editAuctionModal" autoscroll="false"></div>

<form class="form form-horizontal">
	<h4>Auction Search</h4>
	
	<div class="form-group">
		<div class="col-xs-12" role="group" style="z-index: 3">
			<div class="input-group">
				<span class="input-group-btn">
	        <button class="btn btn-default" type="button">
	        	<span class="glyphicon glyphicon-search"></span>
	        </button>
	      </span>
				
				<input class="form-control" type="text" placeholder="[Item Name]"
					ng-model="auctionSort.item.name">
				
				<div class="input-group-btn">
					
					<div class="btn-group">
					  <button class="btn btn-default dropdown-toggle"
					  	type="button" data-toggle="dropdown"
					  	aria-haspopup="true" aria-expanded="false">
					    {{auctionSort.item.keywords.slot || '[SLOT]'}}&nbsp;
					    <span class="caret"></span>
					  </button>
					  <ul class="dropdown-menu">
					    <li>
					  		<a href="" ng-click="auctionSort.item.keywords.slot = '';
					  				auctionSort.item.keywords.class = ''">[SLOT]
					  		</a>
					  	</li>
					    <li ng-repeat="slot in itemData.slotList">
					    	<a href="" ng-click="auctionSort.item.keywords.slot = slot">{{slot}}</a>
					    </li>
					  </ul>
				  </div>
				  
				  <div class="btn-group">
					  <button class="btn btn-default dropdown-toggle"
					  	ng-class="{disabled: !auctionSort.item.keywords.slot
							|| auctionSort.item.keywords.slot === 'Belt'
							|| auctionSort.item.keywords.slot === 'Ring'
							|| auctionSort.item.keywords.slot === 'Amulet'
							|| auctionSort.item.keywords.slot === 'Crafting Item'
							|| auctionSort.item.keywords.slot === 'Chest'
							|| auctionSort.item.keywords.slot === 'Banner'}"
					  	type="button" data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false">
					    {{auctionSort.item.keywords.class || '[CLASS]'}}&nbsp;
					    <span class="caret"></span>
					  </button>
					  <ul class="dropdown-menu">
					  	<li>
					  		<a href="" ng-click="auctionSort.item.keywords.class = ''">[CLASS]</a>
					  	</li>
					  	<li ng-repeat="class in itemData.classList">
					    	<a href="" ng-click="auctionSort.item.keywords.class = class">{{class}}</a>
					    </li>
					  </ul>
					</div>
					
					<div class="btn-group">
					  <button class="btn btn-default dropdown-toggle"
					  	type="button" data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false">
					    {{auctionSort.item.keywords.rarity || '[RARITY]'}}&nbsp;
					    <span class="caret"></span>
					  </button>
					  <ul class="dropdown-menu">
					  	<li>
					  		<a href="" ng-click="auctionSort.item.keywords.rarity = ''">[RARITY]</a>
					  	</li>
					  	<li ng-repeat="rarity in itemData.rarityList">
					    	<a href="" ng-click="auctionSort.item.keywords.rarity = rarity">{{rarity}}</a>
					    </li>
					  </ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="form-group">
		<div class="col-xs-3" style="z-index: 2">
			<h4>Min Price</h4>
			<div numpicker
				numvalue="auctionSort.price.min"
				numvaluemin="105"
				numvaluemax="auctionSort.price.max"
				numdelay="200"></div>
		</div>
		
		<div class="col-xs-3" style="z-index: 2">
			<h4>Max Price</h4>
			<div numpicker
				numvalue="auctionSort.price.max"
				numvaluemin="auctionSort.price.min"
				numvaluemax=""
				numdelay="200"></div>
		</div>
		
		<div class="col-xs-3" style="z-index: 2">
			<h4>Min Level</h4>
			<div numpicker
				numvalue="auctionSort.level.min"
				numvaluemin="1"
				numvaluemax="auctionSort.level.max"
				numdelay="200"></div>
		</div>
		
		<div class="col-xs-3" style="z-index: 2">
			<h4>Max Level</h4>
			<div numpicker
				numvalue="auctionSort.level.max"
				numvaluemin="auctionSort.level.min"
				numvaluemax="46"
				numdelay="200"></div>
		</div>
	</div>
	
	<h4>Auction Search Results</h4>
	<div class="form-group">
		<div class="col-xs-12">
			<table class="table table-condensed table-bordered" style="width: 100%">
				<thead>
					<tr>
						<th>
							<a href="" ng-click="sortType = 'item.name'; sortReverse = !sortReverse">
								Item
								<span ng-show="sortType === 'item.name' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'item.name' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
				      </a>
						</th>
						<th>
							<a href="" ng-click="sortType = 'level'; sortReverse = !sortReverse">
								Level
								<span ng-show="sortType === 'level' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'level' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
						<th>
							<a href="" ng-click="sortType = 'price'; sortReverse = !sortReverse">
								Price
								<span ng-show="sortType === 'price' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'price' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
						<th>
							<a href="" ng-click="sortType = 'item.keywords.slot'; sortReverse = !sortReverse">
								Slot
								<span ng-show="sortType === 'item.keywords.slot' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'item.keywords.slot' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
						<th>
							<a href="" ng-click="sortType = 'item.keywords.class'; sortReverse = !sortReverse">
								Class
								<span ng-show="sortType === 'item.keywords.class' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'item.keywords.class' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
						<th>
							<a href="" ng-click="sortType = 'item.keywords.rarity'; sortReverse = !sortReverse">
								Rarity
								<span ng-show="sortType === 'item.keywords.rarity' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'item.keywords.rarity' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
						
						<th>
							<a href="" ng-click="sortType = 'date'; sortReverse = !sortReverse">
								Date
								<span ng-show="sortType === 'date' && !sortReverse" class="glyphicon glyphicon-triangle-bottom"></span>
				        <span ng-show="sortType === 'date' && sortReverse" class="glyphicon glyphicon-triangle-top"></span>
							</a>
						</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="auction in auctionList
							| orderBy:sortType:sortReverse
							| auctionFilter:auctionSort"
						ng-class="{selected: (auction === currentRow)}"
						ng-click="selectRow(auction)">
						<td>{{auction.item.name}}
							<span class="pull-right">
								
								<div class="socket" title="{{socket.quality}} {{socket.type}} {{socket.category}}"
									ng-repeat="socket in auction.sockets track by $index">
								
		        			<div class="socket-foreground">
									  <img ng-show="socket.type && socket.category"
								  		ng-src="img/sockets/{{socket.quality + socket.type + socket.category | nospace}}.png">
								  </div>
		        			
		        			<div class="socket-background">
	        					<img ng-src="img/sockets/Empty.png">
								  </div>
							  
							  </div>
	        		</span>
	        	</td>
						<td>{{auction.level}}</td>
						<td>{{auction.price}}</td>
						<td>{{auction.item.keywords.slot}}</td>
						<td>{{auction.item.keywords.class}}</td>
						<td>{{auction.item.keywords.rarity}}</td>
						<td>{{auction.date | date:'short'}}</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	
	<div class="form-group">
		<div class="col-xs-12" role="group" style="z-index: 2">
			<div class="input-group">
				<div class="input-group-btn">
					<div class="btn-group btn-group-justified">
						<div class="btn-group">
							<button class="btn btn-default"
								ng-click="readAuction()"
								ng-show="$root.currentUser._id">
									Add Auction
							</button>
						</div>
						<div class="btn-group">
							<button class="btn btn-default"
								ng-click="readAuction(currentRow)"
								ng-show="$root.currentUser._id === currentRow.owner">
									Edit Auction
							</button>
						</div>
						<div class="btn-group">
							<button class="btn btn-default"
								ng-click="deleteAuction(currentRow)"
								ng-show="$root.currentUser._id === currentRow.owner">
									Delete Auction
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
</form>